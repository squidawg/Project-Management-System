<form [formGroup]="createTaskForm">
    <h1 mat-dialog-title>
        {{'shared.add'|translate}}
        {{'shared.task'|translate}}</h1>
    <div mat-dialog-content>
        <mat-form-field appearance="fill">
            <mat-label>{{'modal.desc' | translate}}</mat-label>
            <input
                    matInput
                    formControlName="taskTitle"
            >
            <mat-error *ngIf="!createTaskForm.get('taskTitle')!.valid">{{onError(createTaskForm.get('taskTitle')) | translate}}</mat-error>
            <mat-error></mat-error>
        </mat-form-field>
        <mat-form-field appearance="fill">
            <mat-label>{{'modal.description' | translate}}</mat-label>
            <textarea
                    matInput
                    formControlName="taskDescription"
            >
            </textarea>
            <mat-error *ngIf="!createTaskForm.get('taskDescription')!.valid">{{onError(createTaskForm.get('taskDescription')) | translate}}</mat-error>
        </mat-form-field>
        <mat-form-field class="example-chip-list">
            <mat-label>{{'modal.users' | translate}}</mat-label>
            <mat-chip-grid #chipGrid aria-label="User selection">
                <mat-chip-row
                        *ngFor="let user of selected; let i = index"
                        (removed)="onDeleteUser(user._id)">
                    {{user.name}}
                    <button
                            matChipRemove
                            [attr.aria-label]="'remove ' + user">
                        <mat-icon>cancel</mat-icon>
                    </button>
                </mat-chip-row>
            </mat-chip-grid>
            <input
                   #userInput
                   [formControl]="userCtrl"
                   [matChipInputFor]="chipGrid"
                   [matAutocomplete]="auto"
                   [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                   (matChipInputTokenEnd)="onAddUser($event)"/>
            <mat-autocomplete
                #auto="matAutocomplete"
                (optionSelected)="onSelectUser($event)">
                <mat-option *ngFor="let filteredUser of filteredUsers | async" [value]="filteredUser._id">
                    {{filteredUser.name}}
                </mat-option>
            </mat-autocomplete>
        </mat-form-field>
    </div>
    <div mat-dialog-actions>
        <button
                mat-button
                mat-dialog-close
                [disabled]="!createTaskForm.valid"
                color="primary" (click)="onSubmit()">Add</button>
        <button
                mat-icon-button
                mat-dialog-close
                aria-label="Example icon button with a home icon">
            <mat-icon>close</mat-icon>
        </button>
    </div>
</form>

